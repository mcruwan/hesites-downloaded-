// Передача RoistatVisitID в CRM через форму b24
// Функция для получения значения cookie по имени
function getCookie(name) {
  const matches = document.cookie.match(new RegExp(
    "(?:^|; )" + name.replace(/[$()*+?.^|{}[\]\\]/g, '\\$&') + "=([^;]*)"
  ));
  return matches ? decodeURIComponent(matches[1]) : null;
}

// Событие отправки формы Bitrix24
window.addEventListener('b24:form:submit', (event) => {
  let form = event.detail.object;
  const roistatVisit = getCookie('roistat_visit') || 'nocookie';
  form.setProperty("roistatVisitId", roistatVisit);
  console.log(`Значение roistat_visit передано в форму ID ${form.identification.id}: ${roistatVisit}`);
});